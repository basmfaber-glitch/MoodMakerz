<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MoodMarket â€“ STRESSED</title>
  <style>
    body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif; margin:0; padding:24px; background:#0f1115; color:#eef2ff;}
    h1{margin:0 0 12px 0;}
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(240px,1fr)); gap:14px; margin-top:14px;}
    .card{background:#161a22; border:1px solid #242b3a; border-radius:14px; padding:14px;}
    .name{font-weight:650; margin:0 0 8px 0;}
    a.btn{display:inline-block; padding:10px 12px; border-radius:10px; background:#2a6df6; color:white; text-decoration:none; font-weight:650;}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
    button{padding:10px 12px; border-radius:10px; border:1px solid #2a3244; background:#1b2230; color:#eef2ff; cursor:pointer; font-weight:650;}
    footer{opacity:.75; margin-top:18px; font-size:12px;}
  </style>
</head>
<body>
  <h1>ðŸ˜£ STRESSED</h1>
  <div class="row">
    <button id="shuffleBtn">Shuffle</button>
    <span id="countInfo" style="opacity:.8;"></span>
  </div>

  <div id="grid" class="grid"></div>

  <footer>As an Amazon Associate I earn from qualifying purchases.</footer>

  <script>
    const TAG = "moodmakerz-21";
    const PER_LOAD = 8;

    function amazonLink(asin){
      return `https://www.amazon.nl/dp/${asin}?tag=${encodeURIComponent(TAG)}`;
    }

    function pickRandomUnique(arr, n){
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a.slice(0, Math.min(n, a.length));
    }

    async function load(){
      const res = await fetch("asin-map.json", { cache: "no-store" });
      const map = await res.json();
      const entries = Object.entries(map); // [name, asin]
      document.getElementById("countInfo").textContent = `${entries.length} products in STRESSED`;
      render(entries);
      document.getElementById("shuffleBtn").onclick = () => render(entries);
    }

    function render(entries){
      const chosen = pickRandomUnique(entries, PER_LOAD);
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      for (const [name, asin] of chosen){
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <p class="name">${name}</p>
          <a class="btn" href="${amazonLink(asin)}" target="_blank" rel="nofollow noopener">View on Amazon</a>
        `;
        grid.appendChild(card);
      }
    }

    load();
  </script>
</body>
</html>
