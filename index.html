<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>MoodMarket</title>
<meta name="theme-color" content="#0b1020">
<style>
  :root{ --bg:#0b1020; --text:#eef2ff; --muted:#a6b0cf; --card:#12172a; --border:#2a2f45; }
  body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Inter,Arial,sans-serif; background:var(--bg); color:var(--text);}
  .container{ max-width:1100px; margin:auto; padding:20px;}
  h1{ margin:0 0 6px; }
  p{ margin:0 0 14px; color:var(--muted);}
  .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin: 10px 0 16px;}
  .moods{ display:flex; gap:8px; flex-wrap:wrap; }
  .mood{ padding:8px 14px; border-radius:999px; background:var(--card); border:1px solid var(--border); cursor:pointer; font-size:13px; }
  .mood.active{ background:#7c83ff; color:#0b1020; font-weight:700; border-color:#7c83ff; }
  .btn{ padding:8px 14px; border-radius:999px; background:linear-gradient(90deg,#7c83ff,#2dd4bf); border:none; cursor:pointer; font-weight:800; color:#0b1020; }
  .grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:14px; }
  .card{ background:var(--card); border-radius:14px; overflow:hidden; border:1px solid #1c2237; }
  .thumb{ width:100%; height:160px; object-fit:cover; display:block; background:#0b1020; }
  .inner{ padding:12px; }
  .inner h3{ margin:0 0 10px; font-size:14px; line-height:1.2; }
  .buy{ width:100%; padding:10px; border:none; border-radius:10px; font-weight:800; cursor:pointer;
        background:linear-gradient(90deg,#7c83ff,#2dd4bf); color:#0b1020; }
  .note{
    margin-top:10px;
    font-size:12px;
    color:#8b92b2;
    border:1px dashed rgba(255,255,255,0.12);
    border-radius:12px;
    padding:10px 12px;
    background: rgba(255,255,255,0.03);
  }
  code{ color:#c7d2fe; }
  footer{ margin-top:34px; font-size:12px; color:#8b92b2; text-align:center; }
</style>
</head>
<body>
<div class="container">
  <h1>MoodMarket</h1>
  <p>Choose a mood and discover products that match how you feel. </p>

  <div class="row">
    <div class="moods" id="moods"></div>
    <button class="btn" id="shuffle">Shuffle</button>
  </div>

  <div class="grid" id="grid"></div>

  <div class="note">
    <b>OneLink (international)</b>: Amazon OneLink requires a marketplace-specific script snippet generated in your Associates Central.
    Paste your OneLink script into the placeholder at the bottom of this file (search for <code>ONE_LINK_SNIPPET</code>).
  </div>

  <footer>As an Amazon Associate I earn from qualifying purchases.</footer>
</div>

<script>
const TAG = "moodmakerz-21";
const BASE = "https://www.amazon.nl/s?k=";
const PARAMS = "linkCode=ll2&tag=moodmakerz-21&language=nl_NL&ref_=as_li_ss_tl"; // matches Amazon link builder style
const CATALOG = {"Stressed": ["Herbal Tea", "Breathing Timer", "Guided Meditation", "Aromatherapy Oil", "Weighted Blanket", "Stress Journal", "Noise-Reducing Earbuds", "Body Scan Audio", "Candle Set", "Sleep Mask", "Desk Zen Kit", "Calm Focus Music", "Neck Massager", "Room Spray", "Gentle Yoga Flow", "Mindful Coloring Book", "Stress Ball", "Short Walk Plan", "Bath Salts", "Relaxation Soundscape", "Herbal Tea — Chamomile", "Herbal Tea — Lavender", "Herbal Tea — Peppermint", "Breathing Timer — 5-minute", "Breathing Timer — 10-minute", "Guided Meditation — Beginner-friendly", "Aromatherapy Oil — Travel size", "Weighted Blanket — Budget pick", "Weighted Blanket — Premium pick", "Stress Journal — Night routine", "Noise-Reducing Earbuds — Travel size", "Body Scan Audio — 10-minute", "Candle Set — Lavender", "Sleep Mask — Travel size", "Desk Zen Kit — Budget pick", "Calm Focus Music — 5-minute", "Neck Massager — Premium pick", "Room Spray — Lavender", "Gentle Yoga Flow — 10-minute", "Mindful Coloring Book — Beginner-friendly", "Stress Ball — Budget pick", "Short Walk Plan — 10-minute", "Bath Salts — Lavender", "Relaxation Soundscape — Night routine", "Guided Meditation — 10-minute", "Aromatherapy Oil — Premium pick", "Sleep Mask — Premium pick", "Calm Focus Music — Night routine", "Body Scan Audio — 5-minute"], "Happy": ["Instant Camera", "Mini Photo Printer", "Dance Playlist", "Fun Card Game", "Mocktail Kit", "Gratitude Journal", "Mini Adventure List", "Comedy Special", "Party Lights", "Photo Memory Book", "Friendship Activity Deck", "Cook-Together Recipe Kit", "Portable Speaker", "Craft Night Kit", "Movie Night Box", "Board Game Pick", "Funny Podcast", "Surprise Gift Idea", "Weekend Plan Generator", "Music Discovery Pack", "Instant Camera — For couples", "Instant Camera — For friends", "Mini Photo Printer — Solo", "Dance Playlist — Under €20", "Fun Card Game — Premium", "Mocktail Kit — Outdoor", "Gratitude Journal — Indoor", "Mini Adventure List — 15-minute", "Comedy Special — 30-minute", "Party Lights — Instant", "Photo Memory Book — For couples", "Friendship Activity Deck — For friends", "Cook-Together Recipe Kit — Solo", "Portable Speaker — Under €20", "Craft Night Kit — Premium", "Movie Night Box — Outdoor", "Board Game Pick — Indoor", "Funny Podcast — 15-minute", "Surprise Gift Idea — 30-minute", "Weekend Plan Generator — Instant", "Music Discovery Pack — For couples", "Dance Playlist — For friends", "Gratitude Journal — Solo", "Mocktail Kit — Under €20", "Photo Memory Book — Premium", "Portable Speaker — Outdoor", "Craft Night Kit — Indoor", "Board Game Pick — 15-minute", "Comedy Special — Instant", "Mini Adventure List — Premium"], "Energetic": ["HIIT Timer", "Jump Rope", "Resistance Bands", "Running Playlist", "Electrolyte Mix", "Protein Snack Box", "Mobility Routine", "Push-Up Challenge", "Dance Cardio", "Boxing Workout", "Cycling Plan", "Stretch + Strength Split", "Step Goal Plan", "Interval Training Guide", "5K Training Plan", "Core Routine", "Home Workout Set", "Pre-Workout Warmup", "Hydration Tracker", "Fitness Habit Tracker", "HIIT Timer — 10-minute", "HIIT Timer — 20-minute", "Jump Rope — Beginner", "Resistance Bands — Intermediate", "Running Playlist — No equipment", "Electrolyte Mix — Home", "Protein Snack Box — Gym", "Mobility Routine — Low impact", "Push-Up Challenge — High intensity", "Dance Cardio — Recovery-focused", "Boxing Workout — 10-minute", "Cycling Plan — 20-minute", "Stretch + Strength Split — Beginner", "Step Goal Plan — Intermediate", "Interval Training Guide — No equipment", "5K Training Plan — Home", "Core Routine — Gym", "Home Workout Set — Low impact", "Pre-Workout Warmup — High intensity", "Hydration Tracker — Recovery-focused", "Fitness Habit Tracker — 10-minute", "Jump Rope — 20-minute", "Resistance Bands — Beginner", "Running Playlist — Gym", "Electrolyte Mix — High intensity", "Protein Snack Box — Recovery-focused", "Mobility Routine — 10-minute", "Push-Up Challenge — Beginner", "Dance Cardio — Home", "Boxing Workout — Low impact"], "Creative": ["Writing Prompts", "Sketch Set", "Watercolor Kit", "AI Art Tool", "Design Micro-Course", "Photo Challenge List", "Storytelling Template", "Idea Journal", "Collage Kit", "Creative Timer", "Poetry Prompt Deck", "Color Palette Generator", "Moodboard Starter", "Beginner Animation Lesson", "DIY Craft Box", "Zine-Making Kit", "Songwriting Prompts", "Creative Warmup Routine", "Logo Practice Set", "Typography Mini-Lesson", "Writing Prompts — Beginner", "Writing Prompts — 15-minute", "Sketch Set — 30-minute", "Watercolor Kit — Daily", "AI Art Tool — Weekend", "Design Micro-Course — Minimal tools", "Photo Challenge List — Digital", "Storytelling Template — Analog", "Idea Journal — For creators", "Collage Kit — For fun", "Creative Timer — Beginner", "Poetry Prompt Deck — 15-minute", "Color Palette Generator — 30-minute", "Moodboard Starter — Daily", "Beginner Animation Lesson — Weekend", "DIY Craft Box — Minimal tools", "Zine-Making Kit — Digital", "Songwriting Prompts — Analog", "Creative Warmup Routine — For creators", "Logo Practice Set — For fun", "Typography Mini-Lesson — Beginner", "Sketch Set — Daily", "Watercolor Kit — Weekend", "AI Art Tool — Digital", "Design Micro-Course — For creators", "Idea Journal — Analog", "Collage Kit — Minimal tools", "Photo Challenge List — For fun", "Storytelling Template — 30-minute", "Creative Timer — Daily"], "Tired": ["Sleep Sounds", "Evening Stretch", "Warm Eye Mask", "Neck Pillow", "Blue Light Glasses", "Power Nap Routine", "Screen-Off Ritual", "Early Bedtime Plan", "Calm Audiobook", "Low-Light Lamp", "Foot Soak Routine", "Rest Day Checklist", "Morning Sunlight Habit", "Sleep Mask", "Gentle Yoga", "Breathing for Sleep", "Wind-Down Tea", "White Noise Machine", "Light Reading List", "Relaxing Playlist", "Sleep Sounds — 10-minute", "Sleep Sounds — 15-minute", "Evening Stretch — No screen", "Warm Eye Mask — Travel", "Neck Pillow — Home", "Blue Light Glasses — Budget", "Power Nap Routine — Premium", "Screen-Off Ritual — Quick reset", "Early Bedtime Plan — Deep rest", "Calm Audiobook — Gentle", "Low-Light Lamp — 10-minute", "Foot Soak Routine — 15-minute", "Rest Day Checklist — No screen", "Morning Sunlight Habit — Travel", "Sleep Mask — Home", "Gentle Yoga — Budget", "Breathing for Sleep — Premium", "Wind-Down Tea — Quick reset", "White Noise Machine — Deep rest", "Light Reading List — Gentle", "Relaxing Playlist — 10-minute", "Warm Eye Mask — Home", "Neck Pillow — Travel", "Sleep Sounds — Budget", "Evening Stretch — Gentle", "Blue Light Glasses — Premium", "Power Nap Routine — 15-minute", "Calm Audiobook — Deep rest", "Low-Light Lamp — Quick reset", "Wind-Down Tea — Gentle"]};
const CARDS_PER_REFRESH = 9;

const moodsEl = document.getElementById("moods");
const grid = document.getElementById("grid");
const shuffleBtn = document.getElementById("shuffle");

let currentMood = Object.keys(CATALOG)[0];

// Shuffled order per mood; no repeats until all 50 used
const order = {};
const idx = {};

function ensureOrder(mood){
  const n = CATALOG[mood].length;
  if(!order[mood] || order[mood].length !== n){
    order[mood] = Array.from({length:n}, (_,i)=>i);
    for(let i=n-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [order[mood][i], order[mood][j]] = [order[mood][j], order[mood][i]];
    }
    idx[mood] = 0;
  }
}

function nextBatch(mood, k){
  ensureOrder(mood);
  const n = CATALOG[mood].length;
  const used = new Set();
  const out = [];

  while(out.length < k){
    if(idx[mood] >= n){
      // reshuffle after exhausting all items
      order[mood] = Array.from({length:n}, (_,i)=>i);
      for(let i=n-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [order[mood][i], order[mood][j]] = [order[mood][j], order[mood][i]];
      }
      idx[mood] = 0;
    }
    const pickIndex = order[mood][idx[mood]++];
    const title = CATALOG[mood][pickIndex];
    const key = title.toLowerCase();
    if(used.has(key)) continue; // no duplicates on same page
    used.add(key);
    out.push(title);
  }
  return out;
}

function amazonNlUrl(title){
  const q = encodeURIComponent(title.replace("—"," "));
  // BASE already includes "?k="; we append query then parameters
  return `${BASE}${q}&${PARAMS}`;
}

// Photo-realistic (external) with fallback to local SVG
function photoUrl(title, mood){
  const q = encodeURIComponent((title.replace("—"," ") + " " + mood).trim());
  const u1 = `https://source.unsplash.com/800x450/?${q}`;
  const u2 = `https://loremflickr.com/800/450/${q}`;
  return [u1, u2];
}

function svgFallback(title, mood){
  const safe = title.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
  const safeMood = mood.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
  const svg = `
  <svg xmlns="http://www.w3.org/2000/svg" width="800" height="450">
    <defs>
      <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0" stop-color="#7c83ff" stop-opacity="0.55"/>
        <stop offset="1" stop-color="#2dd4bf" stop-opacity="0.35"/>
      </linearGradient>
    </defs>
    <rect width="800" height="450" fill="#0b1020"/>
    <rect width="800" height="450" fill="url(#g)"/>
    <text x="40" y="95" font-family="Inter,system-ui,Arial" font-size="34" fill="#eef2ff" font-weight="800">${safeMood}</text>
    <text x="40" y="165" font-family="Inter,system-ui,Arial" font-size="30" fill="#eef2ff" font-weight="700">${safe}</text>
  </svg>`;
  return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(svg.trim());
}

function setActiveMood(mood){
  currentMood = mood;
  document.querySelectorAll(".mood").forEach(b=>b.classList.remove("active"));
  document.querySelector(`[data-mood="${mood}"]`).classList.add("active");
  render();
}

function setImgWithFallback(imgEl, urls, fallbackDataUrl){
  let i = 0;
  const tryNext = () => {
    if(i >= urls.length){
      imgEl.src = fallbackDataUrl;
      return;
    }
    imgEl.src = urls[i++];
  };
  imgEl.onerror = tryNext;
  tryNext();
}

function render(){
  grid.innerHTML = "";
  const batch = nextBatch(currentMood, CARDS_PER_REFRESH);

  batch.forEach(title => {
    const url = amazonNlUrl(title);
    const card = document.createElement("div");
    card.className = "card";

    const img = document.createElement("img");
    img.className = "thumb";
    img.alt = title;
    img.loading = "lazy";
    setImgWithFallback(img, photoUrl(title, currentMood), svgFallback(title, currentMood));

    const inner = document.createElement("div");
    inner.className = "inner";
    inner.innerHTML = `<h3>${title}</h3>`;

    const btn = document.createElement("button");
    btn.className = "buy";
    btn.type = "button";
    btn.textContent = "View on Amazon.nl";
    btn.addEventListener("click", ()=> window.open(url, "_blank"));

    inner.appendChild(btn);
    card.appendChild(img);
    card.appendChild(inner);
    grid.appendChild(card);
  });
}

// Build mood buttons
Object.keys(CATALOG).forEach((m,i)=>{
  const btn = document.createElement("div");
  btn.className = "mood" + (i===0 ? " active" : "");
  btn.textContent = m;
  btn.dataset.mood = m;
  btn.addEventListener("click", ()=> setActiveMood(m));
  moodsEl.appendChild(btn);
});

shuffleBtn.addEventListener("click", render);
render();
</script>

<!-- ONE_LINK_SNIPPET (paste your Amazon OneLink script below this line) -->

</body>
</html>
